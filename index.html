<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Config Transformer</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4f46e5">
<link rel="icon" href="icon-192.png">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{font-family:'Poppins',sans-serif;}
.bg-anim{
background:linear-gradient(-45deg,#6366f1,#8b5cf6,#0ea5e9,#4f46e5);
background-size:300% 300%;
animation:grad 10s ease infinite;
}
@keyframes grad{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}
.glass{
backdrop-filter:blur(20px);
background:rgba(255,255,255,.75);
}
.dark .glass{
background:rgba(15,23,42,.75);
}
</style>

<script>
if(localStorage.theme==='dark'||
(!('theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches)){
document.documentElement.classList.add('dark');
}
</script>
</head>

<body class="bg-anim min-h-screen flex items-center justify-center p-4 transition">

<div class="glass w-full max-w-md rounded-3xl shadow-2xl p-8 border border-white/40 dark:border-slate-700">

<div class="flex justify-between items-center mb-6">
<span class="px-3 py-1 text-xs font-bold bg-indigo-600 text-white rounded-full">PREMIUM</span>
<button onclick="toggleTheme()" class="text-xl">ðŸŒ“</button>
</div>

<h1 class="text-3xl font-bold text-center mb-6 text-indigo-700 dark:text-indigo-300">
Config Transformer
</h1>

<!-- Domain -->
<input id="targetDomain" type="text" placeholder="Target Domain"
class="w-full p-3 mb-3 rounded-xl border dark:bg-slate-800 dark:border-slate-600">

<div class="flex gap-2 mb-4">
<button onclick="saveDomain()" class="flex-1 bg-indigo-600 text-white py-2 rounded-xl">
Save
</button>
<button onclick="clearDomain()" class="flex-1 bg-gray-300 dark:bg-slate-700 py-2 rounded-xl">
Clear
</button>
</div>

<!-- Original -->
<textarea id="originalLink" rows="3"
class="w-full p-3 mb-4 rounded-xl border dark:bg-slate-800 dark:border-slate-600"
placeholder="Paste Original VLESS"></textarea>

<button onclick="generateCustomLink()"
class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-xl font-semibold mb-4">
Generate
</button>

<!-- Result -->
<div class="relative">
<textarea id="resultLink" rows="3"
class="w-full p-3 rounded-xl border dark:bg-slate-800 dark:border-slate-600"
placeholder="Result here..."
readonly></textarea>

<button onclick="copyResult()" 
class="absolute right-3 top-3 bg-indigo-600 text-white px-3 py-1 rounded-lg text-sm">
Copy
</button>
</div>

<div class="text-center mt-6 text-sm dark:text-gray-300">
Developer: <span class="font-semibold">SisNaing</span>
</div>

</div>

<script>

// Theme
function toggleTheme(){
document.documentElement.classList.toggle('dark');
localStorage.theme=document.documentElement.classList.contains('dark')?'dark':'light';
}

// Save Domain
function saveDomain(){
const d=document.getElementById("targetDomain").value.trim();
if(!d)return alert("Enter domain first");
localStorage.setItem("savedDomain",d);
alert("Domain Saved");
}

// Load Saved Domain
window.onload=function(){
const saved=localStorage.getItem("savedDomain");
if(saved)document.getElementById("targetDomain").value=saved;
}

// Clear
function clearDomain(){
document.getElementById("targetDomain").value="";
localStorage.removeItem("savedDomain");
}

// Generate
function generateCustomLink(){
const domain=document.getElementById("targetDomain").value.trim();
const original=document.getElementById("originalLink").value.trim();

if(!domain||!original.startsWith("vless://")){
alert("Check input");return;
}

try{
const parts=original.split('#');
const url=new URL(parts[0]);
const uuid=url.username;
const remark=parts[1]||"";   // ðŸ”¥ original remark keep
const path=url.searchParams.get("path")||"/";

const params=new URLSearchParams();
params.set("path",path);
params.set("security","tls");
params.set("type","ws");
params.set("host",domain);
params.set("sni",domain);

const newLink=`vless://${uuid}@${domain}:443?${params.toString()}#${remark}`;

document.getElementById("resultLink").value=newLink;

}catch{
alert("Invalid VLESS format");
}
}

// Copy
function copyResult(){
const text=document.getElementById("resultLink");
text.select();
document.execCommand("copy");
}

if('serviceWorker'in navigator){
navigator.serviceWorker.register('./service-worker.js');
}

</script>
</body>
</html>
