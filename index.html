<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Config Transformer</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4f46e5">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="icon" href="icon-192.png">
<link rel="apple-touch-icon" href="icon-192.png">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

<div class="bg-white p-6 rounded-2xl shadow-xl w-full max-w-md">

<h1 class="text-2xl font-bold text-center mb-6">Config Transformer</h1>

<label class="text-sm font-semibold">Target Domain</label>
<input id="targetDomain" type="text" placeholder="example.com"
class="w-full border rounded-xl p-2 mb-4">

<label class="text-sm font-semibold">Original VLESS</label>
<textarea id="originalLink" rows="3"
class="w-full border rounded-xl p-2 mb-4"
placeholder="vless://..."></textarea>

<button onclick="generateCustomLink()"
class="w-full bg-indigo-600 text-white p-3 rounded-xl mb-4">
Generate
</button>

<textarea id="resultLink" rows="3"
class="w-full border rounded-xl p-2"
placeholder="Result will appear here..."
readonly></textarea>

</div>

<script>
function generateCustomLink() {
  const domain = document.getElementById("targetDomain").value.trim();
  const original = document.getElementById("originalLink").value.trim();

  if (!domain) {
    alert("Enter target domain");
    return;
  }

  if (!original.startsWith("vless://")) {
    alert("Invalid VLESS link");
    return;
  }

  try {
    const parts = original.split('#');
    const url = new URL(parts[0]);
    const uuid = url.username;
    const path = url.searchParams.get("path") || "/";

    const params = new URLSearchParams();
    params.set("path", path);
    params.set("security", "tls");
    params.set("type", "ws");
    params.set("host", domain);
    params.set("sni", domain);

    const newLink = `vless://${uuid}@${domain}:443?${params.toString()}#custom`;

    document.getElementById("resultLink").value = newLink;

  } catch (e) {
    alert("Error parsing VLESS");
  }
}

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js');
}
</script>

</body>
</html>
